var Ee=Object.defineProperty;var Te=(l,a,o)=>a in l?Ee(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o;var ie=(l,a,o)=>Te(l,typeof a!="symbol"?a+"":a,o);import{t as r,v as e,w as V,x as Me}from"./vendor-dlXNBD_Y.js";import{u as ce,m as de,a as he,_ as xe,y as ge,P as pe,b as $e,L as Le,p as _e,n as Ae}from"./esri-D2q4MPL6.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const x of c.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&t(x)}).observe(document,{childList:!0,subtree:!0});function o(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function t(n){if(n.ep)return;n.ep=!0;const c=o(n);fetch(n.href,c)}})();const B=()=>"https://redfive-api-1092564995915.us-central1.run.app",be=r.createContext(void 0),ye=()=>{const l=r.useContext(be);if(l===void 0)throw new Error("useAuth must be used within an AuthProvider");return l},Ie=({children:l})=>{const[a,o]=r.useState(null),[t,n]=r.useState(!0),[c,x]=r.useState(!1);r.useEffect(()=>{if(window.google&&window.google.accounts){console.log("Google Identity Services already loaded"),n(!1);return}if(document.querySelector('script[src="https://accounts.google.com/gsi/client"]')){console.log("Google Identity Services script already exists, waiting for load...");const y=()=>{window.google&&window.google.accounts?(console.log("Google Identity Services loaded successfully"),n(!1)):setTimeout(y,100)};y();return}const M=()=>{window.google&&window.google.accounts?(console.log("Google Identity Services loaded successfully"),n(!1)):(console.log("Waiting for Google Identity Services to load..."),setTimeout(M,100))},N=document.createElement("script");N.src="https://accounts.google.com/gsi/client",N.async=!0,N.defer=!0,N.onload=M,N.onerror=()=>{console.error("Failed to load Google Identity Services script"),n(!1)},document.head.appendChild(N);const C=localStorage.getItem("user"),E=localStorage.getItem("access_token");if(C&&E)try{(T=>{try{const L=JSON.parse(atob(T.split(".")[1])),D=Date.now()/1e3;return L.exp<D}catch(L){return console.error("Error checking token expiration:",L),!0}})(E)?(console.log("Access token is expired, attempting refresh..."),setTimeout(async()=>{const T=localStorage.getItem("refresh_token");if(T){const L=B();try{const D=await fetch(`${L}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({refresh_token:T})});if(D.ok){const q=await D.json();q.access_token&&(localStorage.setItem("access_token",q.access_token),q.refresh_token&&localStorage.setItem("refresh_token",q.refresh_token),console.log("Token refreshed successfully on app startup"),o(JSON.parse(C)))}else localStorage.removeItem("user"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}catch(D){console.error("Token refresh failed on startup:",D),localStorage.removeItem("user"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}}else localStorage.removeItem("user"),localStorage.removeItem("access_token")},100)):o(JSON.parse(C))}catch(y){console.error("Error parsing saved user:",y),localStorage.removeItem("user"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}return()=>{const y=document.querySelector('script[src="https://accounts.google.com/gsi/client"]');y&&y.remove()}},[]);const g={user:a,isAuthenticated:!!a,isLoading:t,login:()=>{if(console.log("Login button clicked"),c){console.log("Login already in progress, ignoring duplicate request");return}if(!window.google||!window.google.accounts){console.error("Google Identity Services not loaded");return}const S="1092564995915-914iml3sjt13lcb6c038cniqe72374h9.apps.googleusercontent.com";console.log("Client ID:",S),x(!0),console.log("Initializing Google OAuth client..."),window.google.accounts.oauth2.initTokenClient({client_id:S,scope:"openid profile email",ux_mode:"redirect",redirect_uri:window.location.origin,callback:N=>{console.log("OAuth callback received:",N),N.access_token?(console.log("Access token received, authenticating with server..."),fetch(`https://www.googleapis.com/oauth2/v2/userinfo?access_token=${N.access_token}`).then(C=>C.json()).then(C=>{console.log("User info received:",C);const E=B();return fetch(`${E}/auth/google`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({access_token:N.access_token,user_info:C})}).then(y=>y.json()).then(y=>{if(console.log("Server authentication response:",y),y.success||y.user){const T={id:y.user?.id||C.id,name:y.user?.name||C.name,email:y.user?.email||C.email,picture:y.user?.picture||C.picture};o(T),localStorage.setItem("user",JSON.stringify(T))}else console.error("Server authentication failed:",y);x(!1)})}).catch(C=>{console.error("Error during authentication:",C),x(!1)})):(console.error("No access token in response:",N),x(!1))}}).requestAccessToken()},logout:()=>{const S=B();fetch(`${S}/auth/logout`,{method:"POST",credentials:"include"}).catch(M=>{console.error("Error during logout:",M)}),o(null),x(!1),localStorage.removeItem("user"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.google&&window.google.accounts&&window.google.accounts.oauth2.revoke()},refreshToken:async()=>{try{const S=localStorage.getItem("refresh_token");if(!S)return console.log("No refresh token available"),!1;const M=B(),N=await fetch(`${M}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({refresh_token:S})});if(!N.ok)return console.error("Token refresh failed:",N.status),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),o(null),!1;const C=await N.json();return C.access_token?(localStorage.setItem("access_token",C.access_token),C.refresh_token&&localStorage.setItem("refresh_token",C.refresh_token),console.log("Token refreshed successfully"),!0):!1}catch(S){return console.error("Token refresh error:",S),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),o(null),!1}}};return e.jsx(be.Provider,{value:g,children:l})},Pe=({children:l})=>{const{isAuthenticated:a,isLoading:o}=ye(),t=r.useRef(null),n=r.useRef(!1);return r.useEffect(()=>{if(!n.current&&!o&&!a&&window.google&&window.google.accounts&&t.current){const c="1092564995915-914iml3sjt13lcb6c038cniqe72374h9.apps.googleusercontent.com";n.current=!0,t.current&&(t.current.innerHTML=""),window.google.accounts.id.initialize({client_id:c,callback:x=>{if(console.log("Google Sign-In response:",x),x.credential){const u=JSON.parse(atob(x.credential.split(".")[1]));console.log("User info from JWT:",u);const d=B();fetch(`${d}/auth/google`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:x.credential})}).then(p=>(console.log("Response status:",p.status),p.ok?p.json():p.json().then(g=>{throw console.error("Server error details:",g),new Error(`Server error: ${JSON.stringify(g)}`)}))).then(p=>{if(console.log("Server authentication response:",p),p.access_token){localStorage.setItem("access_token",p.access_token),localStorage.setItem("refresh_token",p.refresh_token);const g={id:u.sub,name:u.name,email:u.email,picture:u.picture};localStorage.setItem("user",JSON.stringify(g)),console.log("Authentication successful! Stored tokens and user data."),console.log("User data:",g),console.log("Access token:",p.access_token),setTimeout(()=>{window.location.reload()},1e3)}}).catch(p=>{console.error("Authentication error:",p)})}}}),window.google.accounts.id.renderButton(t.current,{theme:"outline",size:"large",text:"signin_with",shape:"rectangular"})}},[o,a]),r.useEffect(()=>()=>{n.current=!1},[]),o?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100vh",backgroundColor:"#f8f9fa"},children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h1",{className:"display-4 fw-bold",style:{color:"#aa0000"},children:[e.jsx("span",{children:"red"}),e.jsx("span",{style:{fontStyle:"italic",opacity:.9},children:"five"})]}),e.jsx("p",{className:"lead text-muted",children:"Data Analytics Workbench"})]}),e.jsx("div",{className:"spinner-border text-primary mb-3",role:"status",style:{width:"3rem",height:"3rem"},children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("h4",{children:"Initializing..."}),e.jsx("p",{className:"text-muted",children:"Setting up authentication"})]})}):a?e.jsx(e.Fragment,{children:l}):e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100vh",backgroundColor:"#f8f9fa"},children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h1",{className:"display-4 fw-bold",style:{color:"#aa0000"},children:[e.jsx("span",{children:"red"}),e.jsx("span",{style:{fontStyle:"italic",opacity:.9},children:"five"})]}),e.jsx("p",{className:"lead text-muted",children:"Data Analytics Workbench"})]}),e.jsx("div",{className:"card shadow-lg border-0",style:{maxWidth:"400px",margin:"0 auto"},children:e.jsxs("div",{className:"card-body p-5",children:[e.jsx("h4",{className:"card-title text-center mb-4",children:"Welcome"}),e.jsx("p",{className:"text-muted text-center mb-4",children:"Sign in with your Google account to continue"}),e.jsx("div",{ref:t,className:"d-flex justify-content-center"})]})}),e.jsx("div",{className:"mt-4",children:e.jsx("small",{className:"text-muted",children:"Secure authentication powered by Google"})})]})})},De=()=>{const{user:l,isAuthenticated:a,isLoading:o,login:t,logout:n}=ye(),c=()=>{t()},x=()=>{n()};return e.jsx("nav",{className:"navbar navbar-expand-lg navbar-dark",style:{flexShrink:0,padding:"0px",backgroundColor:"#495057"},children:e.jsxs("div",{className:"container-fluid",children:[e.jsxs("a",{className:"navbar-brand fw-bold",href:"#",style:{color:"#aa0000",fontSize:"21pt",lineHeight:"1",padding:"0",margin:"0",textShadow:"1px 1px 2px rgba(255, 255, 255, 0.3)"},children:[e.jsx("span",{children:"red"}),e.jsx("span",{style:{fontStyle:"italic",opacity:.9},children:"five"})]}),e.jsx("div",{className:"navbar-nav ms-auto",children:o?e.jsxs("div",{className:"nav-link",children:[e.jsx("i",{className:"bi bi-hourglass-split me-1"}),"Loading..."]}):a&&l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"nav-link d-flex align-items-center",children:[l.picture&&e.jsx("img",{src:l.picture,alt:l.name,className:"rounded-circle me-2",style:{width:"24px",height:"24px"}}),e.jsx("span",{className:"me-3",children:l.name})]}),e.jsxs("a",{className:"nav-link",href:"#",children:[e.jsx("i",{className:"bi bi-gear me-1"}),"Settings"]}),e.jsxs("button",{className:"nav-link btn btn-link text-light text-decoration-none",onClick:x,style:{border:"none",background:"none"},children:[e.jsx("i",{className:"bi bi-box-arrow-right me-1"}),"Logout"]})]}):e.jsxs("button",{className:"nav-link btn btn-link text-light text-decoration-none",onClick:c,style:{border:"none",background:"none"},children:[e.jsx("i",{className:"bi bi-google me-1"}),"Login with Google"]})})]})})};class me{constructor(a,o){ie(this,"baseUrl");ie(this,"apiKey");this.baseUrl=a||B(),this.apiKey=o}async sendPrompt(a){try{const o={query:a},t={"Content-Type":"application/json",Accept:"application/json"},n=await this.getValidToken();n?t.Authorization=`Bearer ${n}`:this.apiKey&&(t.Authorization=`Bearer ${this.apiKey}`),console.log("Sending request to:",`${this.baseUrl}/generate-sql`),console.log("Request body:",o);const c=await fetch(`${this.baseUrl}/generate-sql`,{method:"POST",headers:t,body:JSON.stringify(o),mode:"cors",credentials:"include",cache:"no-cache"});if(console.log("Response status:",c.status),console.log("Response headers:",c.headers),!c.ok){const u=await c.text();throw console.error("Response error:",u),new Error(`HTTP error! status: ${c.status} - ${u}`)}const x=await c.json();return console.log("Response data:",x),{success:!0,data:x,message:"Request processed successfully"}}catch(o){console.error("DataService error:",o);let t="Unknown error occurred";return o instanceof TypeError&&o.message.includes("Failed to fetch")?t=`Network error: Unable to connect to the data service. Please check if the service is running at ${this.baseUrl}`:o instanceof Error&&(t=o.message),{success:!1,error:t,message:"Failed to process request"}}}async executeSql(a){try{const o={sql:a},t={"Content-Type":"application/json",Accept:"application/json"},n=await this.getValidToken();n?t.Authorization=`Bearer ${n}`:this.apiKey&&(t.Authorization=`Bearer ${this.apiKey}`),console.log("Executing SQL:",a),console.log("Sending request to:",`${this.baseUrl}/execute-sql`);const c=await fetch(`${this.baseUrl}/execute-sql`,{method:"POST",headers:t,body:JSON.stringify(o),mode:"cors",credentials:"include",cache:"no-cache"});if(console.log("Response status:",c.status),!c.ok){const u=await c.text();throw console.error("Response error:",u),new Error(`HTTP error! status: ${c.status} - ${u}`)}const x=await c.json();return console.log("SQL execution response:",x),{success:!0,data:x,message:"SQL executed successfully"}}catch(o){console.error("SQL execution error:",o);let t="Unknown error occurred";return o instanceof TypeError&&o.message.includes("Failed to fetch")?t="Network error: Unable to connect to the data service":o instanceof Error&&(t=o.message),{success:!1,error:t,message:"Failed to execute SQL"}}}async getHealth(){try{const a=await fetch(`${this.baseUrl}/health`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return{success:!0,data:await a.json(),message:"Service is healthy"}}catch(a){return console.error("Health check error:",a),{success:!1,error:a instanceof Error?a.message:"Health check failed",message:"Service is unavailable"}}}setBaseUrl(a){this.baseUrl=a}setApiKey(a){this.apiKey=a}async getModels(){try{const a={"Content-Type":"application/json",Accept:"application/json"},o=await this.getValidToken();o?a.Authorization=`Bearer ${o}`:this.apiKey&&(a.Authorization=`Bearer ${this.apiKey}`),console.log("Getting models from:",`${this.baseUrl}/get-models`);const t=await fetch(`${this.baseUrl}/get-models`,{method:"GET",headers:a,mode:"cors",credentials:"include",cache:"no-cache"});if(console.log("Get models response status:",t.status),!t.ok){const c=await t.text();throw console.error("Get models error:",c),new Error(`HTTP error! status: ${t.status} - ${c}`)}const n=await t.json();return console.log("Get models response data:",n),{success:!0,data:n,message:"Models retrieved successfully"}}catch(a){console.error("Get models error:",a);let o="Unknown error occurred";return a instanceof TypeError&&a.message.includes("Failed to fetch")?o="Network error: Unable to connect to the data service":a instanceof Error&&(o=a.message),{success:!1,error:o,message:"Failed to get models"}}}async refreshToken(){try{const a=localStorage.getItem("refresh_token");if(!a)return{success:!1,error:"No refresh token available",message:"Please log in again"};const o={"Content-Type":"application/json",Accept:"application/json"};console.log("Refreshing token...");const t=await fetch(`${this.baseUrl}/auth/refresh`,{method:"POST",headers:o,body:JSON.stringify({refresh_token:a}),mode:"cors",credentials:"include",cache:"no-cache"});if(console.log("Token refresh response status:",t.status),!t.ok){const c=await t.text();return console.error("Token refresh error:",c),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),{success:!1,error:`Token refresh failed: ${c}`,message:"Please log in again"}}const n=await t.json();return console.log("Token refresh response data:",n),n.access_token&&(localStorage.setItem("access_token",n.access_token),n.refresh_token&&localStorage.setItem("refresh_token",n.refresh_token),console.log("Tokens refreshed successfully")),{success:!0,data:n,message:"Token refreshed successfully"}}catch(a){return console.error("Token refresh error:",a),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),{success:!1,error:a instanceof Error?a.message:"Unknown error occurred",message:"Token refresh failed, please log in again"}}}isTokenExpired(a){try{const o=JSON.parse(atob(a.split(".")[1])),t=Date.now()/1e3;return o.exp<t}catch(o){return console.error("Error checking token expiration:",o),!0}}async getValidToken(){const a=localStorage.getItem("access_token");if(!a)return console.log("No access token found"),null;if(this.isTokenExpired(a)){console.log("Access token is expired, attempting refresh...");const o=await this.refreshToken();return o.success&&o.data?.access_token?o.data.access_token:(console.log("Token refresh failed, user needs to re-authenticate"),null)}return a}}const Oe=({className:l="",onTableSelect:a,onColumnSelect:o,onSchemaSelect:t,onModelsLoaded:n,onGenerateSelect:c,onSpatialColumnsLoaded:x})=>{const[u,d]=r.useState({databases:!0,production:!0,"saved-queries":!1}),[p,g]=r.useState([]),[S,M]=r.useState(!1),[N,C]=r.useState({show:!1,x:0,y:0,type:"table",item:null}),E=new me,y=s=>{d(h=>({...h,[s]:!h[s]}))},T=s=>{const h={};let m=[];if(Array.isArray(s))m=s;else if(s&&Array.isArray(s.data))m=s.data;else if(s&&s.models&&Array.isArray(s.models))m=s.models;else return console.warn("Models data is not in expected format:",s),h;return m.forEach(b=>{const v=b.schema||b.schema_name||b.database_schema||"default",j=b.name||b.table_name;h[v]||(h[v]={}),h[v][j]||(h[v][j]=[]),b.columns&&(h[v][j]=b.columns)}),Object.keys(h).forEach(b=>{Object.keys(h[b]).forEach(v=>{h[b][v].sort((j,O)=>j.name.localeCompare(O.name))})}),h},L=s=>{const h=[];return s.forEach(m=>{m.columns&&Array.isArray(m.columns)&&m.columns.forEach(b=>{b.spatial_type&&b.spatial_type!==null&&b.spatial_type!==""&&h.push(b.name)})}),h},D=r.useMemo(()=>p.length===0?{}:T(p),[p]),q=async()=>{console.log("Starting to load models..."),M(!0);try{const s=await E.getModels();if(console.log("Models response:",s),s.success&&s.data){console.log("Models response data:",s.data),console.log("Models data type:",typeof s.data),console.log("Is array:",Array.isArray(s.data)),console.log("Models length:",s.data?.length);let h=[];if(Array.isArray(s.data))h=s.data;else if(s.data.models&&Array.isArray(s.data.models))h=s.data.models;else{console.warn("Could not find models array in response:",s.data),g([]);return}console.log("Extracted models array:",h),g(h);const m=L(h);console.log("Extracted spatial columns:",m),n&&n(h),x&&x(m);const b=T(h),v={databases:!0,production:!0,"saved-queries":!1};Object.keys(b).forEach(j=>{v[`schema-${j}`]=!0}),d(v)}else console.error("Failed to load models:",s.error),g([])}catch(s){console.error("Failed to load models:",s),g([])}finally{M(!1)}};r.useEffect(()=>{q()},[]),r.useEffect(()=>{p.length>0&&n&&n(p)},[p,n]);const R=(s,h,m)=>{s.preventDefault(),s.stopPropagation(),console.log("Context menu triggered for:",h,m),C({show:!0,x:s.clientX,y:s.clientY,type:h,item:m})},k=()=>{C({show:!1,x:0,y:0,type:"table",item:null})};return r.useEffect(()=>{const s=()=>{N.show&&k()};return document.addEventListener("click",s),()=>document.removeEventListener("click",s)},[N.show]),e.jsxs("div",{className:`bg-light border-end d-flex flex-column h-100 ${l}`,style:{overflow:"hidden"},children:[e.jsx("div",{className:"p-2 border-bottom panel-header",style:{background:"linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%)"},children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"text-muted mb-0 d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-folder me-2"}),"Model Explorer"]}),e.jsx("div",{className:"d-flex gap-1",children:e.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:q,disabled:S,title:"Reload models",children:S?e.jsx("i",{className:"bi bi-hourglass-split"}):e.jsx("i",{className:"bi bi-arrow-clockwise"})})})]})}),e.jsx("div",{className:"flex-grow-1",style:{height:"0",minHeight:"0",overflowY:"auto",overflowX:"hidden"},onContextMenu:s=>{s.preventDefault(),s.stopPropagation()},children:S?e.jsxs("div",{className:"p-3 text-center",children:[e.jsx("div",{className:"spinner-border spinner-border-sm text-muted",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("div",{className:"small text-muted mt-2",children:"Loading models..."})]}):p.length>0?e.jsxs(e.Fragment,{children:[Object.entries(D).sort(([s],[h])=>s.localeCompare(h)).map(([s,h])=>e.jsxs("div",{className:"explorer-item",children:[e.jsxs("div",{className:"explorer-folder",onClick:m=>{y(`schema-${s}`),m.target instanceof HTMLElement&&(m.target.tagName==="SPAN"||m.target.closest("span"))&&t&&(console.log("ModelExplorer: Schema selected:",s),t(s))},style:{cursor:"pointer"},children:[e.jsx("i",{className:`bi ${u[`schema-${s}`]?"bi-chevron-down":"bi-chevron-right"} me-1`}),e.jsx("i",{className:"bi bi-folder me-2"}),e.jsx("span",{children:s})]}),u[`schema-${s}`]&&e.jsx("div",{className:"explorer-children",children:Object.entries(h).sort(([m],[b])=>m.localeCompare(b)).map(([m,b])=>{const v=Array.isArray(p)?p.find(j=>j.name===m):null;return e.jsxs("div",{className:"explorer-item",children:[e.jsxs("div",{className:"explorer-folder",onClick:()=>{y(`table-${s}-${m}`),a&&v&&a(v)},onContextMenu:j=>{j.preventDefault(),j.stopPropagation(),R(j,"table",v||{name:m,schema:s})},style:{cursor:"pointer"},children:[e.jsx("i",{className:`bi ${u[`table-${s}-${m}`]?"bi-chevron-down":"bi-chevron-right"} me-1`}),e.jsx("i",{className:"bi bi-table me-2"}),e.jsx("span",{children:m})]}),u[`table-${s}-${m}`]&&e.jsx("div",{className:"explorer-children",children:b.map(j=>e.jsxs("div",{className:"explorer-file",onClick:()=>{o&&o(j.name)},onContextMenu:O=>{O.preventDefault(),O.stopPropagation(),R(O,"column",j)},style:{cursor:"pointer"},children:[e.jsx("i",{className:"bi bi-columns me-2"}),e.jsxs("span",{children:[j.name,j.spatial_type==="point"?e.jsx("span",{style:{color:"#aa0000"},children:"*"}):j.spatial_type==="polyline"?e.jsx("span",{style:{color:"#aa0000"},children:"**"}):j.spatial_type==="polygon"?e.jsx("span",{style:{color:"#aa0000"},children:"***"}):""]}),e.jsxs("span",{className:"text-muted small ms-2",children:["(",j.type,")"]})]},j.name))})]},m)})})]},s)),e.jsxs("div",{className:"explorer-item",children:[e.jsxs("div",{className:"explorer-folder",onClick:()=>y("saved-queries"),children:[e.jsx("i",{className:`bi ${u["saved-queries"]?"bi-chevron-down":"bi-chevron-right"} me-1`}),e.jsx("i",{className:"bi bi-folder me-2"}),e.jsx("span",{children:"Saved Queries"})]}),u["saved-queries"]&&e.jsxs("div",{className:"explorer-children",children:[e.jsxs("div",{className:"explorer-file",children:[e.jsx("i",{className:"bi bi-file-text me-2"}),e.jsx("span",{children:"user_analysis.sql"})]}),e.jsxs("div",{className:"explorer-file",children:[e.jsx("i",{className:"bi bi-file-text me-2"}),e.jsx("span",{children:"sales_report.sql"})]}),e.jsxs("div",{className:"explorer-file",children:[e.jsx("i",{className:"bi bi-file-text me-2"}),e.jsx("span",{children:"inventory_check.sql"})]})]})]})]}):e.jsxs("div",{className:"p-3 text-center text-muted",children:[e.jsx("i",{className:"bi bi-database fs-1 mb-2"}),e.jsx("div",{children:"No models loaded"}),e.jsx("small",{children:"Models will appear here once loaded"})]})}),N.show&&e.jsx("div",{className:"context-menu",style:{position:"fixed",top:N.y,left:N.x,zIndex:9999,backgroundColor:"white",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",padding:"4px 0",minWidth:"180px",fontSize:"14px"},onClick:s=>s.stopPropagation(),children:N.type==="table"&&c&&e.jsxs("div",{className:"context-menu-item",onClick:()=>{c(N.item),C({show:!1,x:0,y:0,type:"table",item:null})},style:{padding:"10px 16px",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"10px",borderBottom:"1px solid #f0f0f0",transition:"background-color 0.2s"},onMouseEnter:s=>{s.currentTarget.style.backgroundColor="#f8f9fa"},onMouseLeave:s=>{s.currentTarget.style.backgroundColor="transparent"},children:[e.jsx("i",{className:"bi bi-code-slash text-success"}),e.jsx("span",{children:"Generate Select"})]})})]})},ze=r.memo(Oe),qe=({selectedTable:l,selectedColumn:a,className:o=""})=>l?e.jsxs("div",{className:`p-3 ${o}`,style:{overflow:"auto",maxHeight:"100%"},children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:"bi bi-table me-2",style:{color:"#aa0000"}}),e.jsx("h4",{className:"mb-0",style:{color:"#aa0000"},children:l.label||l.name})]}),e.jsxs("div",{className:"text-muted small",children:[e.jsx("span",{className:"badge me-2",style:{backgroundColor:"#aa0000",color:"white"},children:l.schema}),e.jsx("span",{className:"badge",style:{backgroundColor:"#f8f9fa",color:"#aa0000",border:"1px solid #aa0000",padding:"0.25em 0.4em",fontSize:"0.75em",fontWeight:"700"},children:l.name})]}),l.description&&e.jsx("p",{className:"mt-2",style:{color:"#666"},children:l.description})]}),l.keys?.primary&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h6",{style:{color:"#aa0000"},children:[e.jsx("i",{className:"bi bi-key me-1",style:{color:"#aa0000"}}),"Primary Key"]}),e.jsx("div",{className:"p-2 rounded",style:{backgroundColor:"#fff5f5",border:"1px solid #ffcccc"},children:e.jsx("code",{style:{color:"#aa0000"},children:l.keys.primary})})]}),l.keys?.foreign&&l.keys.foreign.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h6",{style:{color:"#aa0000"},children:[e.jsx("i",{className:"bi bi-link-45deg me-1",style:{color:"#aa0000"}}),"Foreign Keys"]}),l.keys.foreign.map((t,n)=>e.jsxs("div",{className:"p-2 rounded mb-2",style:{backgroundColor:"#fff5f5",border:"1px solid #ffcccc"},children:[e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#aa0000"},children:"Columns:"})," ",e.jsx("code",{style:{color:"#aa0000"},children:t.columns})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#aa0000"},children:"References:"})," ",e.jsxs("code",{style:{color:"#aa0000"},children:[t.ref_schema,".",t.ref_table,"(",t.ref_columns,")"]})]})]},n))]}),e.jsxs("div",{children:[e.jsxs("h6",{className:"mb-3",style:{color:"#aa0000"},children:[e.jsx("i",{className:"bi bi-columns me-1",style:{color:"#aa0000"}}),"Columns (",l.columns.length,")"]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-sm table-hover",children:[e.jsx("thead",{style:{backgroundColor:"#fff5f5"},children:e.jsxs("tr",{children:[e.jsx("th",{style:{color:"#aa0000",borderBottom:"2px solid #aa0000"},children:"Name"}),e.jsx("th",{style:{color:"#aa0000",borderBottom:"2px solid #aa0000"},children:"Type"}),e.jsx("th",{style:{color:"#aa0000",borderBottom:"2px solid #aa0000"},children:"Nullable"}),e.jsx("th",{style:{color:"#aa0000",borderBottom:"2px solid #aa0000"},children:"Description"})]})}),e.jsx("tbody",{children:l.columns.map(t=>e.jsxs("tr",{className:a===t.name?"table-warning":"",style:a===t.name?{backgroundColor:"#fff5f5"}:{},children:[e.jsxs("td",{children:[e.jsx("code",{className:a===t.name?"fw-bold":"",style:{color:"#aa0000"},children:t.name}),t.label&&t.label!==t.name&&e.jsx("div",{className:"small",style:{color:"#666"},children:t.label})]}),e.jsx("td",{style:{verticalAlign:"middle"},children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("span",{className:"badge",style:{backgroundColor:"#aa0000",color:"white"},children:t.type}),t.spatial_type&&t.spatial_type!==null&&t.spatial_type!==""&&e.jsx("span",{className:"badge ms-2",style:{backgroundColor:"transparent",color:"#aa0000",border:"1px solid #aa0000"},children:t.spatial_type})]})}),e.jsx("td",{children:t.nullable?e.jsx("span",{style:{color:"#666"},children:"Yes"}):e.jsx("span",{className:"fw-bold",style:{color:"#aa0000"},children:"No"})}),e.jsx("td",{className:"small",style:{color:"#666"},children:t.description||"-"})]},t.name))})]})})]})]}):e.jsxs("div",{className:`p-4 text-center text-muted ${o}`,children:[e.jsx("i",{className:"bi bi-info-circle fs-1 mb-3"}),e.jsx("h5",{children:"No Table Selected"}),e.jsx("p",{children:"Select a table from the explorer to view its details"})]}),Fe=({schemaName:l,models:a,className:o=""})=>{const[t,n]=r.useState(""),c=r.useMemo(()=>{const u=[];return a.forEach(d=>{const p=d.schema||d.schema_name||d.database_schema||"default";p===l&&d.columns&&d.columns.forEach(g=>{u.push({name:g.name,table:d.name,type:g.type||"N/A",nullable:g.nullable||!1,description:g.description,schema:p,spatial_type:g.spatial_type})})}),u.sort((d,p)=>d.name!==p.name?d.name.localeCompare(p.name):d.table.localeCompare(p.table))},[a,l]),x=r.useMemo(()=>{if(!t.trim())return c;const u=t.toLowerCase();return c.filter(d=>d.name.toLowerCase().includes(u)||d.table.toLowerCase().includes(u)||d.type.toLowerCase().includes(u)||d.description&&d.description.toLowerCase().includes(u))},[c,t]);return c.length===0?e.jsxs("div",{className:`p-4 text-center text-muted ${o}`,children:[e.jsx("i",{className:"bi bi-database fs-1 mb-3",style:{color:"#aa0000"}}),e.jsx("h5",{style:{color:"#aa0000"},children:"No Columns Found"}),e.jsxs("p",{children:['No columns available for schema "',l,'"']})]}):e.jsxs("div",{className:`p-3 ${o}`,style:{overflow:"auto",maxHeight:"100%"},children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:"bi bi-database me-2",style:{color:"#aa0000"}}),e.jsxs("h4",{className:"mb-0",style:{color:"#aa0000"},children:["Schema: ",l]})]}),e.jsx("div",{className:"text-muted small",children:e.jsxs("span",{className:"badge me-2",style:{backgroundColor:"#aa0000",color:"white"},children:[c.length," columns across ",new Set(c.map(u=>u.table)).size," tables"]})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text",style:{backgroundColor:"#fff5f5",borderColor:"#aa0000"},children:e.jsx("i",{className:"bi bi-search",style:{color:"#aa0000"}})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Filter columns by name, table, type, or description...",value:t,onChange:u=>n(u.target.value),style:{borderColor:"#aa0000"}})]}),t&&e.jsx("div",{className:"mt-2",children:e.jsxs("small",{className:"text-muted",children:["Showing ",x.length," of ",c.length," columns"]})})]}),e.jsxs("div",{children:[e.jsxs("h6",{className:"mb-3",style:{color:"#aa0000"},children:[e.jsx("i",{className:"bi bi-table me-1",style:{color:"#aa0000"}}),"All Columns (",x.length,")"]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-sm table-hover",children:[e.jsx("thead",{style:{backgroundColor:"#fff5f5"},children:e.jsxs("tr",{children:[e.jsx("th",{style:{color:"#aa0000",borderBottom:"2px solid #aa0000"},children:"Column"}),e.jsx("th",{style:{color:"#aa0000",borderBottom:"2px solid #aa0000"},children:"Table"}),e.jsx("th",{style:{color:"#aa0000",borderBottom:"2px solid #aa0000"},children:"Type"}),e.jsx("th",{style:{color:"#aa0000",borderBottom:"2px solid #aa0000"},children:"Nullable"}),e.jsx("th",{style:{color:"#aa0000",borderBottom:"2px solid #aa0000"},children:"Description"})]})}),e.jsx("tbody",{children:x.map((u,d)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("code",{style:{color:"#aa0000"},children:u.name})}),e.jsx("td",{style:{verticalAlign:"middle"},children:e.jsx("span",{className:"badge",style:{backgroundColor:"#f8f9fa",color:"#aa0000",border:"1px solid #aa0000",padding:"0.25em 0.4em",fontSize:"0.75em",fontWeight:"700"},children:u.table})}),e.jsx("td",{style:{verticalAlign:"middle"},children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("span",{className:"badge",style:{backgroundColor:"#aa0000",color:"white"},children:u.type}),u.spatial_type&&u.spatial_type!==null&&u.spatial_type!==""&&e.jsx("span",{className:"badge ms-2",style:{backgroundColor:"transparent",color:"#aa0000",border:"1px solid #aa0000"},children:u.spatial_type})]})}),e.jsx("td",{children:u.nullable?e.jsx("span",{style:{color:"#666"},children:"Yes"}):e.jsx("span",{className:"fw-bold",style:{color:"#aa0000"},children:"No"})}),e.jsx("td",{className:"small",style:{color:"#666"},children:u.description||"-"})]},`${u.table}-${u.name}-${d}`))})]})})]})]})},Re=({queryText:l,onQueryChange:a,onExecute:o,onSave:t,onFormat:n,selectedTable:c,selectedColumn:x,selectedSchema:u,models:d=[],className:p=""})=>{const[g,S]=r.useState([{id:"docs",name:"ðŸ“‹ Models",content:"",isDirty:!1},{id:"1",name:"Query 1",content:"",isDirty:!1}]),M=V.useRef(0),[N,C]=r.useState("1"),[E,y]=r.useState(2);r.useEffect(()=>{S(i=>i.map(f=>f.id===N?{...f,content:l,isDirty:!0}:f)),l&&l.length>M.current&&l.length-M.current>10&&setTimeout(()=>{const i=document.querySelector(".query-editor-textarea");i&&(i.scrollTop=i.scrollHeight)},100),M.current=l.length},[l]);const[T,L]=r.useState(null),[D,q]=r.useState(""),[R,k]=r.useState(0),[s,h]=r.useState(!1),[m,b]=r.useState(!1),[v,j]=r.useState({show:!1,x:0,y:0,tabId:""}),O=g.find(i=>i.id===N),I=()=>{const i={id:E.toString(),name:`Query ${E}`,content:"",isDirty:!1};S(f=>[...f,i]),C(i.id),y(f=>f+1)},z=i=>{if(i==="docs")return;if(g.length<=2){const w={id:E.toString(),name:`Query ${E}`,content:"",isDirty:!1};S(P=>[...P.filter(G=>G.id==="docs"),w]),C(w.id),y(P=>P+1),a("");return}const f=g.filter(w=>w.id!==i);if(S(f),N===i){const w=g.findIndex(G=>G.id===i),P=w>0?w-1:0;C(f[P].id)}},W=i=>{C(i);const f=g.find(w=>w.id===i);f&&a(f.content)},$=i=>{S(f=>f.map(w=>w.id===N?{...w,content:i,isDirty:i!==""}:w)),a(i)},Z=()=>{const i=document.querySelector(".query-editor-textarea");if(i){const f=i.selectionStart,w=i.selectionEnd;if(f!==w)return i.value.substring(f,w).trim()}return null},U=r.useCallback(()=>{const i=Z();i?o(i):o()},[o]),K=i=>{const f=g.find(w=>w.id===i);f&&(L(i),q(f.name))},J=()=>{T&&D.trim()&&S(i=>i.map(f=>f.id===T?{...f,name:D.trim()}:f)),L(null),q("")},ee=()=>{L(null),q("")},se=i=>{i.key==="Enter"?J():i.key==="Escape"&&ee()},Q=()=>{const i=document.querySelector(".tab-scroll-container");if(i){const f=Math.max(0,R-200);i.scrollLeft=f,k(f)}},Y=()=>{const i=document.querySelector(".tab-scroll-container");if(i){const f=i.scrollWidth-i.clientWidth,w=Math.min(f,R+200);i.scrollLeft=w,k(w)}},te=()=>{const i=document.querySelector(".tab-scroll-container");if(i){const f=i.scrollWidth-i.clientWidth;h(R>0),b(R<f)}};V.useEffect(()=>{te()},[g,R]);const re=(i,f)=>{i.preventDefault(),j({show:!0,x:i.clientX,y:i.clientY,tabId:f})},H=()=>{j({show:!1,x:0,y:0,tabId:""})},ae=i=>{const f=g.find(w=>w.id===i);if(f){const w={id:E.toString(),name:`${f.name} (Copy)`,content:f.content,isDirty:!1};S(P=>[...P,w]),C(w.id),y(P=>P+1)}H()},oe=()=>{const i=g.find(w=>w.id==="docs"),f={id:E.toString(),name:`Query ${E}`,content:"",isDirty:!1};S([i,f].filter(w=>w!==void 0)),C(f.id),y(w=>w+1),a(""),H()},ne=i=>{const f=g.find(P=>P.id===i),w=g.find(P=>P.id==="docs");f&&(S((i==="docs"?[w]:[w,f]).filter(G=>G!==void 0)),C(i)),H()},le=i=>{const f=g.findIndex(G=>G.id===i),w=g.find(G=>G.id==="docs"),P=g.slice(0,f+1);w&&!P.includes(w)&&P.unshift(w),S(P),C(i),H()};return V.useEffect(()=>{const i=()=>{v.show&&H()};return document.addEventListener("click",i),()=>document.removeEventListener("click",i)},[v.show]),V.useEffect(()=>{const i=f=>{f.key==="Enter"&&(f.ctrlKey||f.metaKey)&&N!=="docs"&&!T&&(f.preventDefault(),U())};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[N,T,U]),e.jsxs("div",{className:`bg-light border-start d-flex flex-column h-100 ${p}`,style:{overflow:"hidden"},children:[e.jsx("div",{className:"border-bottom",style:{flexShrink:0,paddingTop:"calc(0.5rem - 3px)",borderBottomWidth:"1px"},children:e.jsxs("div",{className:"d-flex align-items-center",children:[s&&e.jsx("button",{className:"scroll-arrow scroll-arrow-left",onClick:Q,title:"Scroll left",children:e.jsx("i",{className:"bi bi-chevron-left"})}),e.jsxs("div",{className:"tab-scroll-container d-flex flex-grow-1",style:{overflow:"hidden"},children:[g.map(i=>e.jsxs("div",{className:`tab-item ${N===i.id?"active":""}`,onClick:()=>W(i.id),onContextMenu:f=>re(f,i.id),children:[T===i.id?e.jsx("input",{type:"text",value:D,onChange:f=>q(f.target.value),onBlur:J,onKeyDown:se,className:"tab-edit-input",autoFocus:!0,onClick:f=>f.stopPropagation()}):e.jsx(e.Fragment,{children:e.jsx("span",{className:"tab-name",onDoubleClick:f=>{f.stopPropagation(),K(i.id)},children:i.name})}),i.id!=="docs"&&e.jsx("button",{className:"tab-close",onClick:f=>{f.stopPropagation(),z(i.id)},children:e.jsx("i",{className:"bi bi-x"})})]},i.id)),e.jsx("div",{className:"tab-item new-tab-tab",onClick:I,title:"New Query",children:e.jsx("i",{className:"bi bi-plus"})})]}),m&&e.jsx("button",{className:"scroll-arrow scroll-arrow-right",onClick:Y,title:"Scroll right",children:e.jsx("i",{className:"bi bi-chevron-right"})})]})}),e.jsx("div",{className:"flex-grow-1 d-flex flex-column",style:{minHeight:0,position:"relative",overflow:"hidden"},children:N==="docs"?e.jsx("div",{className:"flex-grow-1",style:{overflow:"auto",maxHeight:"100%"},children:u?e.jsx(Fe,{schemaName:u,models:d,className:"h-100"}):e.jsx(qe,{selectedTable:c,selectedColumn:x,className:"h-100"})}):e.jsx("div",{className:"p-3 d-flex flex-column flex-grow-1",children:e.jsx("textarea",{className:"form-control font-monospace flex-grow-1 query-editor-textarea",value:O?.content||"",onChange:i=>$(i.target.value),placeholder:"Enter your SQL query here or use the AI Assistant to generate it for you.",style:{resize:"none",overflow:"auto",scrollbarWidth:"thin"}})})}),e.jsx("div",{className:"p-3 border-top",style:{flexShrink:0},children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("button",{className:"btn",style:{backgroundColor:"#aa0000",borderColor:"#aa0000",color:"white"},onClick:U,children:[e.jsx("i",{className:"bi bi-play me-1"}),"Execute"]}),e.jsxs("button",{className:"btn btn-outline-secondary",onClick:t,children:[e.jsx("i",{className:"bi bi-save me-1"}),"Save"]}),e.jsxs("button",{className:"btn btn-outline-secondary",onClick:n,children:[e.jsx("i",{className:"bi bi-arrow-clockwise me-1"}),"Format"]})]})}),v.show&&e.jsxs("div",{className:"context-menu",style:{position:"fixed",top:v.y,left:v.x,zIndex:1e3},onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"context-menu-item",onClick:()=>ae(v.tabId),children:[e.jsx("i",{className:"bi bi-files me-2"}),"Duplicate Tab"]}),e.jsxs("div",{className:"context-menu-item",onClick:oe,children:[e.jsx("i",{className:"bi bi-x-square me-2"}),"Close All"]}),e.jsxs("div",{className:"context-menu-item",onClick:()=>ne(v.tabId),children:[e.jsx("i",{className:"bi bi-x-circle me-2"}),"Close Others"]}),e.jsxs("div",{className:"context-menu-item",onClick:()=>le(v.tabId),children:[e.jsx("i",{className:"bi bi-arrow-right-square me-2"}),"Close Others to the Right"]})]})]})},We=r.memo(Re),Ge=({results:l,columns:a,isExecuting:o,error:t,selectedRowIndex:n,onRowSelect:c})=>{const x=r.useRef(null);return r.useEffect(()=>{const u=p=>{if(l.length!==0){if(p.key==="ArrowDown"){p.preventDefault();const g=n===null?0:Math.min(n+1,l.length-1);c(g)}else if(p.key==="ArrowUp"){p.preventDefault();const g=n===null?0:Math.max(n-1,0);c(g)}}},d=x.current;if(d)return d.addEventListener("keydown",u),()=>d.removeEventListener("keydown",u)},[l.length,n,c]),r.useEffect(()=>{l.length>0&&n===null&&c(0)},[l.length,n,c]),e.jsxs("div",{ref:x,className:"p-2 flex-grow-1 d-flex flex-column",style:{height:"100%",overflow:"hidden"},tabIndex:0,onFocus:()=>{x.current&&x.current.focus()},children:[o&&e.jsx("div",{className:"d-flex justify-content-center align-items-center flex-grow-1",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner-border text-danger",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("div",{className:"mt-2 text-muted",children:"Executing query..."})]})}),t&&e.jsxs("div",{className:"alert alert-danger",role:"alert",children:[e.jsx("i",{className:"bi bi-exclamation-triangle me-2"}),e.jsx("strong",{children:"Query Error:"})," ",t]}),!o&&!t&&l.length>0&&e.jsx("div",{className:"flex-grow-1",style:{overflowY:"auto",overflowX:"auto",height:"calc(100% - 60px)",maxHeight:"calc(100% - 60px)",scrollbarWidth:"thin"},children:e.jsxs("table",{className:"table table-striped table-hover table-sm",style:{whiteSpace:"nowrap",fontSize:"0.875rem"},children:[e.jsx("thead",{className:"sticky-top",children:e.jsx("tr",{children:a.map((u,d)=>e.jsx("th",{style:{whiteSpace:"nowrap",padding:"0.5rem 0.6rem 0.4rem 0.6rem",lineHeight:"1.2",color:"white",backgroundColor:"#495057",border:"none"},children:u},d))})}),e.jsx("tbody",{children:l.map((u,d)=>e.jsx("tr",{className:n===d?"table-row-selected":"",style:{lineHeight:"1.2",cursor:"pointer",transition:"background-color 0.2s ease",backgroundColor:n===d?"#e3f2fd":"transparent"},onClick:()=>c(d),onMouseEnter:p=>{n!==d&&(p.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:p=>{n!==d&&(p.currentTarget.style.backgroundColor="transparent")},children:a.map((p,g)=>e.jsx("td",{style:{whiteSpace:"nowrap",padding:"0.4rem 0.6rem",lineHeight:"1.2"},children:u[p]!==null&&u[p]!==void 0?String(u[p]):e.jsx("span",{className:"text-muted",children:"NULL"})},g))},d))})]})}),!o&&!t&&l.length===0&&e.jsx("div",{className:"d-flex justify-content-center align-items-center flex-grow-1",children:e.jsxs("div",{className:"text-center text-muted",children:[e.jsx("i",{className:"bi bi-table display-4 mb-3"}),e.jsx("div",{children:"No results to display"}),e.jsx("small",{children:"Execute a query to see results here"})]})})]})},He=r.memo(Ge),Be=({metadata:l})=>e.jsxs("div",{className:"p-3 flex-grow-1 d-flex flex-column",style:{height:"100%",overflow:"hidden"},children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center mb-2",children:e.jsxs("h6",{className:"text-muted mb-0",children:[e.jsx("i",{className:"bi bi-graph-up me-2"}),"Analysis"]})}),l?e.jsx("div",{className:"flex-grow-1",style:{overflow:"auto"},children:e.jsx("pre",{className:"bg-light p-3 rounded",style:{fontSize:"0.875rem",lineHeight:"1.4",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(l,null,2)})}):e.jsx("div",{className:"d-flex justify-content-center align-items-center flex-grow-1",children:e.jsxs("div",{className:"text-center text-muted",children:[e.jsx("i",{className:"bi bi-graph-up display-4 mb-3"}),e.jsx("div",{children:"No Analysis Available"}),e.jsx("small",{children:"Execute a query to see execution metadata"})]})})]}),Ue=r.memo(Be),Ke=({results:l,columns:a,onRowSelect:o,selectedRowIndex:t})=>{const n=r.useRef(null),c=r.useRef(null),[x,u]=r.useState(!1),[d,p]=r.useState(null),[g,S]=r.useState(null),M=r.useRef("");r.useEffect(()=>n.current?((async()=>{try{const s=document.createElement("link");s.rel="stylesheet",s.href="https://js.arcgis.com/4.29/esri/themes/light/main.css",document.head.appendChild(s);const h=new Le({basemap:"gray-vector"}),m=new _e({container:n.current,map:h,center:[-98.5795,39.8283],zoom:4});c.current=m,await m.when(),u(!0),m.on("click",v=>{m.hitTest(v).then(j=>{if(j.results.length>0){const O=j.results[0].graphic;if(O&&O.attributes&&O.attributes.id!==void 0){const I=O.attributes.id;S(I),o&&o(I)}}})});const b=new Ae;h.add(b),l&&l.length>0&&E(l,a,b,!0)}catch(s){console.error("Error initializing map:",s),p("Failed to initialize map")}})(),()=>{c.current&&(c.current.destroy(),c.current=null)}):void 0,[]);const N=(k,s)=>{const h=JSON.stringify({results:k,columns:s});return btoa(h).slice(0,16)};r.useEffect(()=>{if(x&&l&&l.length>0&&c.current){const k=c.current.map.layers.find(s=>s.type==="graphics");if(k){const s=N(l,a||[]),h=s!==M.current;console.log("MapTab: Processing spatial data",{isNewDataset:h,currentHash:M.current,newHash:s}),k.removeAll(),E(l,a||[],k,h),h&&(M.current=s)}}},[l,a,x]),r.useEffect(()=>{if(x&&c.current){const k=c.current.map.layers.find(s=>s.type==="graphics");k&&C(k,g)}},[g,x]),r.useEffect(()=>{const k=h=>{if(!(!l||l.length===0||!o)){if(h.key==="ArrowDown"){h.preventDefault();const b=Math.min((t??-1)+1,l.length-1);o(b)}else if(h.key==="ArrowUp"){h.preventDefault();const b=Math.max((t??0)-1,0);o(b)}}},s=n.current;if(s)return s.addEventListener("keydown",k),()=>s.removeEventListener("keydown",k)},[l,t,o]),r.useEffect(()=>{t!=null&&t!==g&&S(t)},[t,g]);const C=(k,s)=>{k&&k.graphics.forEach(h=>{const m=h.attributes.id===s;h.geometry.type==="point"?h.symbol=new ce({color:m?"white":"#aa0000",size:m?12:8,outline:m?{color:"#aa0000",width:2}:{color:"#aa0000",width:2},style:"circle"}):h.geometry.type==="polyline"?h.symbol=new de({color:m?"#ff0000":"#aa0000",width:m?5:3}):h.geometry.type==="polygon"&&(h.symbol=new he({color:m?[255,0,0,.5]:[170,0,0,.3],outline:{color:m?"#ff0000":"#aa0000",width:m?3:2}}))})},E=(k,s=[],h,m=!0)=>{if(!k||k.length===0)return;const b=s.filter(v=>k.some(j=>j[v]&&typeof j[v]=="string"&&(j[v].includes("POINT")||j[v].includes("LINESTRING")||j[v].includes("POLYGON")||j[v].startsWith("point:")||j[v].startsWith("linestring:")||j[v].startsWith("polygon:"))));if(b.length===0){console.log("No spatial data found in results");return}k.forEach((v,j)=>{b.forEach(O=>{const I=v[O];if(I)try{let z,W;if(I.startsWith("point:")){const $=T(I);$&&(z=new xe({longitude:$.longitude,latitude:$.latitude,spatialReference:{wkid:$.crs}}),W=new ce({color:"white",size:8,outline:{color:"#aa0000",width:2},style:"circle"}))}else if(I.startsWith("linestring:")){const $=L(I);$&&(z=new ge({paths:[$.coordinates],spatialReference:{wkid:$.crs}}),W=new de({color:"#aa0000",width:3}))}else if(I.startsWith("polygon:")){const $=D(I);$&&(z=new pe({rings:$.rings,spatialReference:{wkid:$.crs}}),W=new he({color:[170,0,0,.3],outline:{color:"#aa0000",width:2}}))}else if(I.includes("POINT")){const $=y(I);$&&(z=new xe({longitude:$[0],latitude:$[1],spatialReference:{wkid:4326}}),W=new ce({color:"white",size:8,outline:{color:"#aa0000",width:2},style:"circle"}))}else if(I.includes("LINESTRING")){const $=q(I);$&&(z=new ge({paths:[$],spatialReference:{wkid:4326}}),W=new de({color:"#aa0000",width:3}))}else if(I.includes("POLYGON")){const $=R(I);$&&(z=new pe({rings:$,spatialReference:{wkid:4326}}),W=new he({color:[170,0,0,.3],outline:{color:"#aa0000",width:2}}))}if(z&&W){const $=new $e({geometry:z,symbol:W,attributes:{id:j,...v}});h.add($)}}catch(z){console.warn(`Error processing spatial data for row ${j}:`,z)}})}),console.log("MapTab: processSpatialData",{shouldZoom:m,graphicsCount:h.graphics.length}),m&&h.graphics.length>0&&(console.log("MapTab: Zooming to graphics"),c.current?.goTo(h.graphics))},y=k=>{const s=k.match(/POINT\s*\(\s*([-\d.]+)\s+([-\d.]+)\s*\)/i);return s?[parseFloat(s[1]),parseFloat(s[2])]:null},T=k=>{const s=k.match(/^point:\s*([-\d.]+),\s*([-\d.]+),\s*(\d+)$/i);return s?{longitude:parseFloat(s[1]),latitude:parseFloat(s[2]),crs:parseInt(s[3])}:null},L=k=>{const s=k.match(/^linestring:\s*([^,]+(?:,[^,]+)*),\s*(\d+)$/i);if(s){const h=s[1].split(",");if(h.length>=4&&h.length%2===0){const m=[];for(let b=0;b<h.length;b+=2)m.push([parseFloat(h[b]),parseFloat(h[b+1])]);return{coordinates:m,crs:parseInt(s[2])}}}return null},D=k=>{const s=k.match(/^polygon:\s*\(([^)]+)\),\s*(\d+)$/i);if(s){const h=s[1].split(",");if(h.length>=6&&h.length%2===0){const m=[];for(let b=0;b<h.length;b+=2)m.push([parseFloat(h[b]),parseFloat(h[b+1])]);return{rings:[m],crs:parseInt(s[2])}}}return null},q=k=>{const s=k.match(/LINESTRING\s*\((.*?)\)/i);return s?s[1].split(",").map(m=>{const[b,v]=m.trim().split(/\s+/);return[parseFloat(b),parseFloat(v)]}):null},R=k=>{const s=k.match(/POLYGON\s*\((.*?)\)/i);return s?s[1].split("),(").map(m=>m.replace(/[()]/g,"").split(",").map(v=>{const[j,O]=v.trim().split(/\s+/);return[parseFloat(j),parseFloat(O)]})):null};return e.jsx("div",{className:"flex-grow-1 d-flex flex-column",style:{height:"100%",overflow:"hidden"},children:d?e.jsx("div",{className:"d-flex justify-content-center align-items-center flex-grow-1",children:e.jsxs("div",{className:"text-center text-danger",children:[e.jsx("i",{className:"bi bi-exclamation-triangle display-4 mb-3"}),e.jsx("div",{children:"Map Error"}),e.jsx("small",{children:d})]})}):e.jsx("div",{ref:n,className:"flex-grow-1",style:{height:"100%",width:"100%"},tabIndex:0,onFocus:()=>{n.current&&n.current.focus()}})})},Je=r.memo(Ke),Qe=({results:l,columns:a,rowCount:o,isExecuting:t,error:n,selectedRowIndex:c,onRowSelect:x,metadata:u,spatialColumns:d=[],className:p=""})=>{const[g,S]=r.useState("table"),M=d.some(N=>a.includes(N));return r.useEffect(()=>{g==="map"&&!M&&S("table")},[g,M]),e.jsxs("div",{className:`flex-grow-1 d-flex flex-column results-panel ${p}`,style:{height:"100%",overflow:"hidden"},children:[e.jsx("div",{className:"border-bottom",style:{flexShrink:0,paddingTop:"calc(0.5rem - 3px)",borderBottomWidth:"1px"},children:e.jsxs("div",{className:"d-flex",children:[e.jsx("div",{className:`tab-item ${g==="table"?"active":""}`,onClick:()=>S("table"),children:e.jsxs("span",{className:"tab-name",children:[e.jsx("i",{className:"bi bi-table me-1"}),"Results",o>0&&e.jsxs("span",{className:"ms-1",children:["(",o,")"]})]})}),e.jsx("div",{className:`tab-item ${g==="analysis"?"active":""}`,onClick:()=>S("analysis"),children:e.jsxs("span",{className:"tab-name",children:[e.jsx("i",{className:"bi bi-graph-up me-1"}),"Analysis"]})}),M&&e.jsx("div",{className:`tab-item ${g==="map"?"active":""}`,onClick:()=>S("map"),children:e.jsxs("span",{className:"tab-name",children:[e.jsx("i",{className:"bi bi-geo-alt me-1"}),"Map"]})})]})}),e.jsxs("div",{className:"flex-grow-1 d-flex flex-column",style:{height:"100%",overflow:"hidden"},children:[g==="table"&&e.jsx(He,{results:l,columns:a,rowCount:o,isExecuting:t,error:n,selectedRowIndex:c,onRowSelect:x}),g==="analysis"&&e.jsx(Ue,{metadata:u}),g==="map"&&M&&e.jsx(Je,{results:l,columns:a,onRowSelect:x,selectedRowIndex:c})]})]})},Ye=r.memo(Qe),Xe=({results:l,columns:a,isExecuting:o,error:t,selectedRow:n,isCollapsed:c,onToggle:x,className:u=""})=>c?e.jsxs("div",{className:`bg-light border-start d-flex flex-column h-100 ${u}`,style:{height:"100%"},children:[e.jsx("div",{className:"p-2 border-bottom flex-shrink-0 d-flex justify-content-center",children:e.jsx("button",{className:"btn btn-sm",style:{backgroundColor:"#aa0000",borderColor:"#aa0000",color:"white"},onClick:x,title:"Expand results details",children:e.jsx("i",{className:"bi bi-chevron-left"})})}),e.jsx("div",{className:"flex-grow-1 d-flex justify-content-center align-items-center",children:e.jsx("div",{style:{writingMode:"vertical-rl",textOrientation:"mixed",transform:"rotate(360deg)",fontSize:"1rem",fontWeight:"500",color:"#aa0000"},children:"Details"})})]}):e.jsxs("div",{className:`bg-light border-start d-flex flex-column h-100 ${u}`,style:{height:"100%",overflow:"hidden"},children:[e.jsx("div",{className:"border-bottom flex-shrink-0",style:{padding:"calc(0.3125rem + 3px) 0.5rem"},children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"bi bi-info-circle me-1"}),"Details"]}),e.jsx("button",{className:"btn btn-sm",style:{backgroundColor:"#aa0000",borderColor:"#aa0000",color:"white"},onClick:x,title:"Collapse details panel",children:e.jsx("i",{className:"bi bi-chevron-right"})})]})}),e.jsxs("div",{className:"flex-grow-1 p-3",style:{overflow:"auto"},children:[n&&e.jsx("div",{children:e.jsx("div",{className:"table-responsive",children:e.jsx("table",{className:"table table-sm table-striped",style:{fontSize:"0.875rem"},children:e.jsx("tbody",{children:a.map((d,p)=>e.jsxs("tr",{children:[e.jsx("td",{className:"fw-bold text-muted",style:{width:"40%",whiteSpace:"nowrap"},children:d}),e.jsx("td",{className:"text-truncate",style:{maxWidth:"200px"},title:n[d]!==null&&n[d]!==void 0?String(n[d]):"NULL",children:n[d]!==null&&n[d]!==void 0?String(n[d]):e.jsx("span",{className:"text-muted",children:"NULL"})})]},p))})})})}),!n&&l.length>0&&e.jsxs("div",{className:"text-center text-muted",children:[e.jsx("i",{className:"bi bi-info-circle display-4 mb-3"}),e.jsx("div",{children:"No row selected"}),e.jsx("small",{children:"Click on a row in the results table to view its details"})]}),l.length===0&&!o&&!t&&e.jsxs("div",{className:"text-center text-muted",children:[e.jsx("i",{className:"bi bi-table display-4 mb-3"}),e.jsx("div",{children:"No results to display"}),e.jsx("small",{children:"Execute a query to see results"})]})]})]}),Ve=r.memo(Xe),Ze=({className:l="",onSqlGenerated:a,isCollapsed:o=!1,onToggle:t})=>{const[n,c]=r.useState([]),[x,u]=r.useState(""),[d,p]=r.useState(!1),g=r.useRef(null),S=new me;r.useEffect(()=>{g.current&&(g.current.scrollTop=g.current.scrollHeight)},[n]);const M=async()=>{if(x.trim()&&!d){const E={id:Date.now(),text:x,sender:"user"};c(y=>[...y,E]),u(""),p(!0);try{const y=await S.sendPrompt(x);if(y.success&&y.data)if(console.log("Response data:",y.data),console.log("Sql:",y.data.sql),console.log("onSqlGenerated prop:",a),y.data.sql){console.log("Calling onSqlGenerated with:",y.data.sql),a?a(y.data.sql):console.log("onSqlGenerated is not defined!");const T={id:Date.now()+1,text:"Your SQL is in the query editor.",sender:"ai"};c(L=>[...L,T])}else{const T=JSON.stringify(y.data,null,2),L={id:Date.now()+1,text:`**Data Service Response:**
\`\`\`json
${T}
\`\`\``,sender:"ai"};c(D=>[...D,L])}else{const T={id:Date.now()+1,text:`**Error:** ${y.error||"Failed to get response from data service"}`,sender:"ai"};c(L=>[...L,T])}}catch(y){const T={id:Date.now()+1,text:`**Error:** ${y instanceof Error?y.message:"Unknown error occurred"}`,sender:"ai"};c(L=>[...L,T])}finally{p(!1)}}},N=E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),M())},C=()=>{c([])};return o?e.jsxs("div",{className:`bg-light border-start d-flex flex-column h-100 ${l}`,style:{height:"100%"},children:[e.jsx("div",{className:"p-2 border-bottom flex-shrink-0 d-flex justify-content-center",children:e.jsx("button",{className:"btn btn-sm",style:{backgroundColor:"#aa0000",borderColor:"#aa0000",color:"white"},onClick:t,title:"Expand chat panel",children:e.jsx("i",{className:"bi bi-chevron-left"})})}),e.jsx("div",{className:"flex-grow-1 d-flex justify-content-center align-items-center",children:e.jsx("div",{style:{writingMode:"vertical-rl",textOrientation:"mixed",transform:"rotate(360deg)",fontSize:"1rem",fontWeight:"500",color:"#aa0000"},children:"AI Assistant"})})]}):e.jsxs("div",{className:`bg-light border-start d-flex flex-column h-100 ${l}`,style:{height:"100%"},children:[e.jsx("div",{className:"p-2 border-bottom flex-shrink-0 panel-header",style:{background:"linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%)",borderBottomWidth:"2px"},children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"text-muted mb-0 d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-chat-dots me-2"}),"AI Assistant"]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn btn-sm",style:{backgroundColor:"#aa0000",borderColor:"#aa0000",color:"white"},onClick:C,disabled:n.length===0,title:"Clear chat history",children:e.jsx("i",{className:"bi bi-trash"})}),e.jsx("button",{className:"btn btn-sm",style:{backgroundColor:"#aa0000",borderColor:"#aa0000",color:"white"},onClick:t,title:"Collapse chat panel",children:e.jsx("i",{className:"bi bi-chevron-right"})})]})]})}),e.jsx("div",{ref:g,className:"flex-grow-1 p-3 overflow-auto chat-panel-scroll d-flex flex-column",children:e.jsxs("div",{className:"flex-grow-1",children:[n.map(E=>e.jsx("div",{className:`mb-3 ${E.sender==="user"?"text-end":"text-start"}`,children:e.jsx("div",{className:`d-inline-block p-2 rounded ${E.sender==="user"?"text-white":"bg-white border"}`,style:E.sender==="user"?{backgroundColor:"#aa0000"}:{},children:E.text})},E.id)),d&&e.jsx("div",{className:"mb-3 text-start",children:e.jsxs("div",{className:"d-inline-block p-2 rounded bg-white border",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"spinner-border spinner-border-sm text-danger me-2",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("span",{className:"text-muted",children:"Generating response..."})]}),e.jsx("div",{className:"progress mt-2",style:{height:"4px"},children:e.jsx("div",{className:"progress-bar bg-danger",role:"progressbar",style:{width:"100%",animation:"progress-bar-stripes 1s linear infinite"}})})]})})]})}),e.jsx("div",{className:"p-3 border-top flex-shrink-0",children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("textarea",{className:"form-control flex-grow-1",placeholder:d?"Almost there...":"redfive standing by...",value:x,onChange:E=>u(E.target.value),onKeyPress:N,disabled:d,rows:3,style:{resize:"vertical",minHeight:"75px"}}),e.jsx("button",{className:"btn align-self-start",style:{backgroundColor:"#aa0000",borderColor:"#aa0000",color:"white",marginTop:"2px"},onClick:M,disabled:d||!x.trim(),children:d?e.jsx("i",{className:"bi bi-hourglass-split"}):e.jsx("i",{className:"bi bi-send"})})]})})]})},ue=({onResize:l,className:a=""})=>{const o=r.useRef(null),t=r.useRef(!1),n=r.useRef(0);return r.useEffect(()=>{const c=d=>{o.current?.contains(d.target)&&(t.current=!0,n.current=d.clientX,document.body.style.cursor="col-resize",document.body.style.userSelect="none",d.preventDefault())},x=d=>{if(t.current){const p=d.clientX-n.current;l(p),n.current=d.clientX}},u=()=>{t.current&&(t.current=!1,document.body.style.cursor="",document.body.style.userSelect="")};return document.addEventListener("mousedown",c),document.addEventListener("mousemove",x),document.addEventListener("mouseup",u),()=>{document.removeEventListener("mousedown",c),document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",u)}},[l]),e.jsx("div",{ref:o,className:`resize-handle ${a}`,style:{width:"4px",backgroundColor:"#dee2e6",cursor:"col-resize",position:"relative",flexShrink:0},children:e.jsx("div",{style:{position:"absolute",top:0,left:"-2px",right:"-2px",bottom:0,backgroundColor:"transparent"}})})},es=({onResize:l,className:a=""})=>{const o=r.useRef(null),t=r.useRef(!1),n=r.useRef(0);return r.useEffect(()=>{const c=d=>{o.current?.contains(d.target)&&(t.current=!0,n.current=d.clientY,document.body.style.cursor="row-resize",document.body.style.userSelect="none",d.preventDefault())},x=d=>{if(t.current){const p=d.clientY-n.current;l(p),n.current=d.clientY}},u=()=>{t.current&&(t.current=!1,document.body.style.cursor="",document.body.style.userSelect="")};return document.addEventListener("mousedown",c),document.addEventListener("mousemove",x),document.addEventListener("mouseup",u),()=>{document.removeEventListener("mousedown",c),document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",u)}},[l]),e.jsx("div",{ref:o,className:`horizontal-resize-handle ${a}`,style:{height:"4px",backgroundColor:"#dee2e6",cursor:"row-resize",position:"relative",flexShrink:0,width:"100%"},children:e.jsx("div",{style:{position:"absolute",top:"-2px",left:0,right:0,bottom:"-2px",backgroundColor:"transparent"}})})};function ss(){const[l,a]=r.useState(""),[o,t]=r.useState([]),[n,c]=r.useState([]),[x,u]=r.useState(0),[d,p]=r.useState(!1),[g,S]=r.useState(null),M=r.useMemo(()=>new me,[]),[N,C]=r.useState(312),[E,y]=r.useState(437),T=150,L=500,[D,q]=r.useState(50),R=20,k=80,[s,h]=r.useState(!1),[m,b]=r.useState(!0),[v,j]=r.useState(600),O=200,I=800,[z,W]=r.useState(null),[$,Z]=r.useState(null),[U,K]=r.useState(null),[J,ee]=r.useState(null),[se,Q]=r.useState(null),[Y,te]=r.useState([]),[re,H]=r.useState([]),ae=r.useCallback(async _=>{const F=_||l;p(!0),S(null);try{const A=await M.executeSql(F);A.success&&A.data?(t(A.data.data||[]),c(A.data.columns||[]),u(A.data.row_count||0),A.data.metadata&&Z(A.data.metadata)):(S(A.error||"Failed to execute query"),console.error("Query execution failed:",A.error))}catch(A){S(A instanceof Error?A.message:"Unknown error occurred"),console.error("Query execution error:",A)}finally{p(!1)}},[l,M]),oe=r.useCallback(()=>{},[l]),ne=r.useCallback(()=>{},[l]),le=r.useCallback(_=>{a(F=>F.trim()?`${F}

${_}`:_)},[]),i=r.useCallback(_=>{C(F=>{const A=F+_;return Math.max(T,Math.min(L,A))})},[T,L]),f=r.useCallback(_=>{y(F=>{const A=F-_;return Math.max(T,Math.min(L,A))})},[T,L]),w=r.useCallback(_=>{q(F=>{const A=_/window.innerHeight*100,X=F+A;return Math.max(R,Math.min(k,X))})},[R,k]),P=r.useCallback(()=>{h(_=>!_)},[]),G=r.useCallback(()=>{b(_=>!_)},[]),je=r.useCallback(_=>{j(F=>{const A=F-_;return Math.max(O,Math.min(I,A))})},[O,I]),ve=r.useCallback(_=>{K(_),Q(null)},[]),Ne=r.useCallback(_=>{Q(_),K(null)},[]),we=r.useCallback(_=>{const F=_.schema||"public",A=_.name,X=`SELECT * FROM ${F}.${A};`;a(fe=>fe.trim()?`${fe}

-- Generated SELECT for ${A}:
${X}`:X)},[]),ke=r.useCallback(_=>{H(_)},[]),Se=r.useMemo(()=>z!==null?o[z]:null,[z,o]),Ce=r.useMemo(()=>Y,[Y]);return e.jsx(Ie,{children:e.jsx(Pe,{children:e.jsxs("div",{className:"d-flex flex-column",style:{height:"100vh",margin:0,padding:0},children:[e.jsx(De,{}),e.jsxs("div",{className:"flex-grow-1 d-flex",style:{height:"calc(100vh - 56px)",overflow:"hidden"},children:[e.jsx("div",{style:{width:`${N}px`,flexShrink:0,height:"100%"},children:e.jsx(ze,{onTableSelect:ve,onColumnSelect:ee,onSchemaSelect:Ne,onModelsLoaded:te,onGenerateSelect:we,onSpatialColumnsLoaded:ke})}),e.jsx(ue,{onResize:i}),e.jsxs("div",{className:"flex-grow-1 d-flex flex-column",style:{minWidth:0},children:[e.jsx("div",{style:{height:`${D}%`,flexShrink:0},children:e.jsx(We,{queryText:l,onQueryChange:a,onExecute:ae,onSave:oe,onFormat:ne,selectedTable:U,selectedColumn:J||void 0,selectedSchema:se||void 0,models:Ce,className:"h-100"})}),e.jsx(es,{onResize:w}),e.jsxs("div",{style:{height:`${100-D}%`,flexShrink:0},className:"d-flex",children:[e.jsx("div",{className:"flex-grow-1",style:{minWidth:0},children:e.jsx(Ye,{results:o,columns:n,rowCount:x,isExecuting:d,error:g,selectedRowIndex:z,onRowSelect:W,metadata:$,spatialColumns:re})}),!m&&e.jsx(ue,{onResize:je}),e.jsx("div",{style:{width:m?"40px":`${v}px`,flexShrink:0,transition:"width 0.3s ease"},children:e.jsx(Ve,{results:o,columns:n,rowCount:x,isExecuting:d,error:g,selectedRow:Se,isCollapsed:m,onToggle:G})})]})]}),e.jsx(ue,{onResize:f}),e.jsx("div",{style:{width:s?"40px":`${E}px`,flexShrink:0,transition:"width 0.3s ease"},children:e.jsx(Ze,{onSqlGenerated:le,isCollapsed:s,onToggle:P})})]})]})})})}Me.createRoot(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(ss,{})}));
